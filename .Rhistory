pacman::p_load(sjmisc,
tidyverse,
haven,
dplyr)
remotes::install_github("leifeld/texreg")
datos <- read_dta("input/data/esi.dta")
datos <- datos %>% select(ingresos = ing_t_d,
educacion = cine,
sexo,
edad)
View(datos)
str(datos)
class(datos)
sjPlot::view_df(datos)
sjPlot::view_df(datos)
class(datos$ingresos)
class(datos$educacion)
class(datos$sexo)
class(datos$edad)
?factor
datos$educacion <- factor(datos$educacion)
class(datos$educacion)
datos$sexo <- factor(datos$sexo)
class(datos$sexo)
sjPlot::view_df(datos)
datos <- read_dta("input/data/esi.dta")
datos <- datos %>% select(ingresos = ing_t_d,
educacion = cine,
sexo,
edad)
datos$educacion <- as_factor(datos$educacion)
class(datos$educacion)
datos$sexo <- as_factor(datos$sexo)
class(datos$sexo)
sjPlot::view_df(datos)
load(url("https://github.com/learn-R/09-class/raw/main/output/data/datos_proc.RData"))
datos <- read_dta("input/data/datos_proc.rds")
datos <- readRDS("input/data/datos_proc.rds")
View(datos)
sjPlot::view_df(datos)
class(datos$ingresos)
class(datos$educacion)
class(datos$sexo)
class(datos$edad)
datos$educacion <- as_factor(datos$educacion)
class(datos$educacion)
datos$sexo <- as_factor(datos$sexo)
class(datos$sexo)
sjPlot::view_df(datos)
datos <- readRDS("input/data/datos_proc.rds")
datos$educacion <- as_factor(datos$educacion)
class(datos$educacion)
datos$sexo <- as_factor(datos$sexo)
class(datos$sexo)
sjPlot::view_df(datos)
frq(datos$ingresos)
descr(datos$ingresos)
descr(datos$edad)
frq(datos$educacion)
datos$educacion <- car::recode(datos$educacion, "'Nivel ignorado' = NA")
frq(datos$educacion)
?relevel
datos$educacion <- relevel(datos$educacion, ref = 'Nunca estudió')
frq(datos$educacion)
frq(datos$educacion)
datos <- datos %>% mutate(.$educación = car::recode(datos$educacion, "'Nivel ignorado' = NA; c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria'"), as.factor = T, levels = c('Nunca estudió', 'Educación preescolar'))
datos <- readRDS("input/data/datos_proc.rds")
class(datos$ingresos)
class(datos$educacion)
class(datos$sexo)
class(datos$edad)
datos$educacion <- as_factor(datos$educacion)
class(datos$educacion)
datos$sexo <- as_factor(datos$sexo)
class(datos$sexo)
datos <- datos %>% mutate(.$educación = car::recode(datos$educacion, "'Nivel ignorado' = NA; c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria'"), as.factor = T, levels = c('Nunca estudió', 'Educación preescolar', 'Educación primaria', 'Educación secundaria', 'Educación técnica (Educación superior no universitaria)', 'Educación universitaria', 'Postitulos y maestría', 'Doctorado'))
datos <- datos %>% mutate(.$educacion = car::recode(datos$educacion, "'Nivel ignorado' = NA; c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria'"), as.factor = T, levels = c('Nunca estudió', 'Educación preescolar', 'Educación primaria', 'Educación secundaria', 'Educación técnica (Educación superior no universitaria)', 'Educación universitaria', 'Postitulos y maestría', 'Doctorado'))
datos <- datos %>% mutate(.$educacion = car::recode(.$educacion, "'Nivel ignorado' = NA; c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria'"), as.factor = T, levels = c('Nunca estudió', 'Educación preescolar', 'Educación primaria', 'Educación secundaria', 'Educación técnica (Educación superior no universitaria)', 'Educación universitaria', 'Postitulos y maestría', 'Doctorado'))
datos <- datos %>% mutate(educacion = car::recode(.$educacion, "'Nivel ignorado' = NA; c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria'"), as.factor = T, levels = c('Nunca estudió', 'Educación preescolar', 'Educación primaria', 'Educación secundaria', 'Educación técnica (Educación superior no universitaria)', 'Educación universitaria', 'Postitulos y maestría', 'Doctorado'))
datos <- datos %>% mutate(educacion = car::recode(.$educacion, c("'Nivel ignorado' = NA;
datos <- datos %>% mutate(educacion = car::recode(.$educacion, c("'Nivel ignorado' = NA;
c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria'")),
as.factor = T,
levels = c('Nunca estudió',
'Educación preescolar',
'Educación primaria',
'Educación secundaria',
'Educación técnica (Educación superior no universitaria)',
'Educación universitaria',
'Postitulos y maestría',
'Doctorado'))
datos <- datos %>% mutate(educacion = car::recode(.$educacion, recodes = c("'Nivel ignorado' = NA;
c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria'")),
as.factor = T,
levels = c('Nunca estudió',
'Educación preescolar',
'Educación primaria',
'Educación secundaria',
'Educación técnica (Educación superior no universitaria)',
'Educación universitaria',
'Postitulos y maestría',
'Doctorado'))
View(datos)
datos <- da7tos %>% mutate(educacion = car::recode(.$educacion, recodes = c("'Nivel ignorado' = NA;
c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria'")),
levels = c('Nunca estudió',
'Educación preescolar',
'Educación primaria',
'Educación secundaria',
'Educación técnica (Educación superior no universitaria)',
'Educación universitaria',
'Postitulos y maestría',
'Doctorado'))
datos <- datos %>% mutate(educacion = car::recode(.$educacion, recodes = c("'Nivel ignorado' = NA;
c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria'")),
levels = c('Nunca estudió',
'Educación preescolar',
'Educación primaria',
'Educación secundaria',
'Educación técnica (Educación superior no universitaria)',
'Educación universitaria',
'Postitulos y maestría',
'Doctorado'))
View(datos)
datos <- car::recode(datos$educacion, recodes = c("'Nivel ignorado' = NA;
c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria'"))
datos <- readRDS("input/data/datos_proc.rds")
datos$educacion <- as_factor(datos$educacion)
class(datos$educacion)
datos$sexo <- as_factor(datos$sexo)
datos$educacion <- car::recode(datos$educacion, recodes = c("'Nivel ignorado' = NA;
c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria'"))
datos$educacion <- factor(datos$educacion, levels = c('Nunca estudió',
'Educación preescolar',
'Educación primaria',
'Educación secundaria',
'Educación técnica (Educación superior no universitaria)',
'Educación universitaria',
'Postitulos y maestría',
'Doctorado'))
frq(datos$educacion)
datos <- readRDS("input/data/datos_proc.rds")
datos$educacion <- as_factor(datos$educacion)
class(datos$educacion)
datos$sexo <- as_factor(datos$sexo)
datos$educacion <- car::recode(datos$educacion, recodes = c("'Nivel ignorado' = NA;
c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria'; 'Educación técnica (Educación superior no universitaria)' = 'Educación técnica'"))
datos$educacion <- factor(datos$educacion, levels = c('Nunca estudió',
'Educación preescolar',
'Educación primaria',
'Educación secundaria',
'Educación técnica',
'Educación universitaria',
'Postitulos y maestría',
'Doctorado'))
frq(datos$educacion)
pacman::p_load(sjmisc,
tidyverse,
haven,
dplyr,
summarytools)
view(dfSummary(datos, headings = FALSE, method = "render"))
?ifelse
datos$ingresos_d <- ifelse(datos$ingresos>mean(datos$ingresos), 1, 0)
View(datos)
view(dfSummary(datos, headings = FALSE, method = "render"))
modelo <- glm(ingresos_d~educacion+sexo+edad,data = enacoes,family = "binomial")
modelo <- glm(ingresos_d~educacion+sexo+edad, data = datos, family = "binomial")
View(modelo)
pacman::p_load(sjmisc,
tidyverse,
haven,
dplyr,
summarytools)
remotes::install_github("leifeld/texreg")
library(texreg)
datos <- readRDS("input/data/datos_proc.rds")
sjPlot::view_df(datos)
datos$educacion <- as_factor(datos$educacion)
class(datos$educacion)
datos$sexo <- as_factor(datos$sexo)
class(datos$sexo)
datos$educacion <- car::recode(datos$educacion, recodes = c("'Nivel ignorado' = NA;
c('Educación primaria (nivel 1)', 'Educación primaria (nivel 2)') = 'Educación primaria';
'Educación técnica (Educación superior no universitaria)' = 'Educación técnica'"))
datos$educacion <- factor(datos$educacion, levels = c('Nunca estudió',
'Educación preescolar',
'Educación primaria',
'Educación secundaria',
'Educación técnica',
'Educación universitaria',
'Postitulos y maestría',
'Doctorado'))
datos$ingresos_d <- ifelse(datos$ingresos>mean(datos$ingresos), 1, 0)
view(dfSummary(datos, headings = FALSE, method = "render"))
modelo <- glm(ingresos_d~educacion+sexo+edad, data = datos, family = "binomial")
htmlreg(modelo)
screenreg(modelo)
frq(datos$educacion)
?relevel
datos$sexo <- relevel(datos$sexo, ref = 'Mujer')
modelo_r <- glm(ingresos_d~educacion+sexo+edad, data = datos, family = "binomial")
htmlreg(list(modelo, modelo_r))
screenreg(list(modelo, modelo_r))
frq(datos$sexo)
frq(datos$educacion)
modelo$coefficients
#Intercepto     #Sexo = 1           #Edad=30          # Coeficientes por niv. educacional
ed1 <-  -4.154460739 + (-0.689068360*1) + (0.008182972*30) + (-2.863120264*1) + (1.979842584*0) + (3.237433957*0) + (3.919341964*0) + (3.804298234*0) + (5.002527182*0) + (5.376563982*0)
ed2 <-  -4.154460739 + (-0.689068360*1) + (0.008182972*30) + (-2.863120264*0) + (1.979842584*1) + (3.237433957*0) + (3.919341964*0) + (3.804298234*0) + (5.002527182*0) + (5.376563982*0)
ed3 <-  -4.154460739 + (-0.689068360*1) + (0.008182972*30) + (-2.863120264*0) + (1.979842584*0) + (3.237433957*1) + (3.919341964*0) + (3.804298234*0) + (5.002527182*0) + (5.376563982*0)
ed4 <-  -4.154460739 + (-0.689068360*1) + (0.008182972*30) + (-2.863120264*0) + (1.979842584*0) + (3.237433957*0) + (3.919341964*1) + (3.804298234*0) + (5.002527182*0) + (5.376563982*0)
ed5 <-  -4.154460739 + (-0.689068360*1) + (0.008182972*30) + (-2.863120264*0) + (1.979842584*0) + (3.237433957*0) + (3.919341964*0) + (3.804298234*1) + (5.002527182*0) + (5.376563982*0)
ed6 <-  -4.154460739 + (-0.689068360*1) + (0.008182972*30) + (-2.863120264*0) + (1.979842584*0) + (3.237433957*0) + (3.919341964*0) + (3.804298234*0) + (5.002527182*1) + (5.376563982*0)
ed7 <-  -4.154460739 + (-0.689068360*1) + (0.008182972*30) + (-2.863120264*0) + (1.979842584*0) + (3.237433957*0) + (3.919341964*0) + (3.804298234*0) + (5.002527182*0) + (5.376563982*1)
pr_ed1 <- exp(ed1)/(1+exp(ed1))
pr_ed2 <- exp(ed2)/(1+exp(ed2))
pr_ed3 <- exp(ed3)/(1+exp(ed3))
pr_ed4 <- exp(ed4)/(1+exp(ed4))
pr_ed5 <- exp(ed5)/(1+exp(ed5))
pr_ed6 <- exp(ed6)/(1+exp(ed6))
pr_ed7 <- exp(ed7)/(1+exp(ed7))
or <- texreg::extract(modelo)
or@coef <- exp(or@coef)
htmlreg(l = list(modelo, or), doctype = F, caption = "", caption.above = T, custom.model.names = c("Modelo", "Modelo (OR)"), custom.coef.names = coef.labs, ci.force = c(TRUE, TRUE), override.coef = list(coef(modelo), or@coef), custom.note = "$^{***}$ p < 0.001; $^{**}$ p < 0.01; $^{*}$ p < 0.05 <br> Errores estándar entre paréntesis. <br> **Nota**: La significancia estadística de los coeficientes en unidades de Odds ratio está calculada en base a los valores $t$, <br> los cuales a su vez se calculan en base a $log(Odds)/SE$")
sjPlot::tab_model(modelo, show.ci=FALSE, p.style = "stars", dv.labels = "Modelo",string.pred = "Predictores", string.est = "β")
sjPlot::tab_model(list(modelo, or), show.ci=FALSE, p.style = "stars", dv.labels = c("Modelo"," Modelo (OR)"),string.pred = "Predictores", string.est = "β")
View(or)
View(modelo)
View(or)
plot_model(modelo, show.values = TRUE)+ theme_sjplot()
library(sjPlot)
plot_model(modelo, show.values = TRUE)+ theme_sjplot()
plot_model(list(modelo, or), show.values = TRUE)+ theme_sjplot()
print(dfSummary(datos, headings = FALSE, method = "render"))
modelo_odds <- glm(ingresos_d~educacion+sexo+edad, data = datos, family = binomial(link="logit"))
plot_model(list(modelo, modelo_odds), show.values = TRUE)+ theme_sjplot()
pacman::p_load(sjmisc,
tidyverse,
haven,
dplyr,
summarytools,
sjPlot)
plot_model(list(modelo, modelo_odds), show.values = TRUE)+ theme_sjplot()
View(modelo_odds)
screenreg(modelo_odds)
screenreg(modelo)
exp(-2.86)
?tab_model
sjPlot::tab_model(modelo,
transform = "exp",
show.ci=FALSE,
p.style = "stars",
dv.labels = "Modelo",
string.pred = "Predictores",
string.est = "β")
?plot_model
plot_model(modelo,
transform = "exp",
show.values = TRUE)+
theme_sjplot()
plot_model(modelo, show.values = TRUE)+ theme_sjplot()
sjPlot::tab_model(modelo, modelo_odds,
transform = "exp",
show.ci=FALSE,
p.style = "stars",
dv.labels = c("Modelo"," Modelo (OR)"),
string.pred = "Predictores",
string.est = "β")
datos$ingresos_d <- factor(datos$ingresos, levels = c('Bajo la media', 'Sobre la media'))
view(dfSummary(datos, headings = FALSE, method = "render")) #Formato HTML
pacman::p_load(sjmisc,
tidyverse,
haven,
dplyr,
summarytools,
sjPlot)
view(dfSummary(datos, headings = FALSE, method = "render")) #Formato HTML
class(datos$ingresos_d)
datos$ingresos_d <- ifelse(datos$ingresos>mean(datos$ingresos), 1, 0)
datos$ingresos_d <- datos %>% car::recode(.$ingresos, recodes = c("0 = 'Bajo la media'; 1 = 'Sobre la media'"),
as.factor = T,
levels = c('Bajo la media',
'Sobre la media'))
datos$ingresos_d <- ifelse(datos$ingresos>mean(datos$ingresos), 1, 0)
datos$ingresos_d <- as.numeric(datos$ingresos_d)
datos$ingresos_d <- datos %>% car::recode(.$ingresos, recodes = c("0 = 'Bajo la media'; 1 = 'Sobre la media'"),
as.factor = T,
levels = c('Bajo la media',
'Sobre la media'))
datos$ingresos_d <- ifelse(datos$ingresos>mean(datos$ingresos), 1, 0)
datos$ingresos_d <- as.factor(datos$ingresos_d)
print(dfSummary(datos, headings = FALSE, method = "render")) #Visualización en consola
datos$ingresos_d <- ifelse(datos$ingresos>mean(datos$ingresos), 1, 0)
datos$ingresos_d <- as.factor(datos$ingresos_d, levels = c(0, 1),
labels = c('Bajo la linea', 'Sobre la linea'))
datos$ingresos_d <- ifelse(datos$ingresos>mean(datos$ingresos), 1, 0)
pacman::p_load(sjmisc,
tidyverse,
haven,
dplyr,
sjPlot)
?glm
pacman::p_load(tidyverse,
haven,
dplyr,
car,
sjmisc,
sjlabelled)
pacman::p_load(tidyverse,
haven,
dplyr,
car,
sjmisc,
sjlabelled,
forcats)
data <- read_dta("https://www.ine.cl/docs/default-source/encuesta-suplementaria-de-ingresos/bbdd/stata_esi/2020/esi-2020---personas.dta?sfvrsn=7a4b0e2b_4&download=true")
data_p <- data %>%
select(ing_t_t,
edad,
sexo,
est_conyugal,
ciuo88,
fact_cal_esi)
find_var(data, 'ocupa')
data_p <- data %>%
select(ing_t_t,
edad,
sexo,
est_conyugal,
ciuo08 = b1,
fact_cal_esi)
data_p <- data_p %>%
mutate_at(vars(sexo, est_conyugal, ciuo08), ~(forcats::as_factor(.)))
str(data_p)
data_p <- data_p %>%
mutate_at(vars(sexo, est_conyugal, ciuo08), ~(forcats::as_factor(.))) %>%
na.omit(.)
frq(data_p$sexo)
frq(data_p$est_conyugal)
